syntax = "proto3";

// The main ToyDB service used by ToyDB clients.
service ToyDB {
  // Status asks the server for its status.
  rpc Status(StatusRequest) returns (StatusResponse) {};

  // Echo is a simple echo service.
  rpc Echo(EchoRequest) returns (EchoResponse) {};

  // Query runs an SQL query.
  rpc Query(QueryRequest) returns (stream Row) {};

  // Get is a temporary key-value command.
  rpc Get(GetRequest) returns (GetResponse) {};

  // Set is a temporary key-value command.
  rpc Set(SetRequest) returns (SetResponse) {};
};

message StatusRequest {};

message StatusResponse {
  string id = 1;
  string version = 2;
  int64 time = 3;
};

message EchoRequest {
  string value = 1;
};

message EchoResponse {
  string value = 1;
}

message QueryRequest {
  string query = 1;
};

message Row {
  repeated Field field = 1;
};

message Field {
  oneof value {
    bool boolean = 1;
    int64 integer = 2;
    double float = 3;
    string string = 4;
  };
}

message GetRequest {
  string key = 1;
}

message GetResponse {
  string key = 1;
  string value = 2;
}

message SetRequest {
  string key = 1;
  string value = 2;
}

message SetResponse {
  string key = 1;
  string value = 2;
}