Query: EXPLAIN SELECT m.id, m.title, g.name FROM movies m JOIN GENRES g ON m.genre_id = g.id WHERE m.released >= 2000

AST: Explain(
    Select {
        select: SelectClause {
            expressions: [
                Field(
                    Some(
                        "m",
                    ),
                    "id",
                ),
                Field(
                    Some(
                        "m",
                    ),
                    "title",
                ),
                Field(
                    Some(
                        "g",
                    ),
                    "name",
                ),
            ],
            labels: [
                None,
                None,
                None,
            ],
        },
        from: Some(
            FromClause {
                items: [
                    Join {
                        left: Table {
                            name: "movies",
                            alias: Some(
                                "m",
                            ),
                        },
                        right: Table {
                            name: "genres",
                            alias: Some(
                                "g",
                            ),
                        },
                        type: Inner,
                        predicate: Some(
                            Operation(
                                Equal(
                                    Field(
                                        Some(
                                            "m",
                                        ),
                                        "genre_id",
                                    ),
                                    Field(
                                        Some(
                                            "g",
                                        ),
                                        "id",
                                    ),
                                ),
                            ),
                        ),
                    },
                ],
            },
        ),
        where: Some(
            WhereClause(
                Operation(
                    GreaterThanOrEqual(
                        Field(
                            Some(
                                "m",
                            ),
                            "released",
                        ),
                        Literal(
                            Integer(
                                2000,
                            ),
                        ),
                    ),
                ),
            ),
        ),
        group_by: None,
        having: None,
        order: [],
        limit: None,
        offset: None,
    },
)

Plan: Plan(
    Explain(
        Projection {
            source: Filter {
                source: NestedLoopJoin {
                    outer: Scan {
                        table: "movies",
                        alias: Some(
                            "m",
                        ),
                    },
                    inner: Scan {
                        table: "genres",
                        alias: Some(
                            "g",
                        ),
                    },
                    predicate: Some(
                        Equal(
                            Field(
                                Some(
                                    "m",
                                ),
                                "genre_id",
                            ),
                            Field(
                                Some(
                                    "g",
                                ),
                                "id",
                            ),
                        ),
                    ),
                    pad: false,
                    flip: false,
                },
                predicate: Or(
                    GreaterThan(
                        Field(
                            Some(
                                "m",
                            ),
                            "released",
                        ),
                        Constant(
                            Integer(
                                2000,
                            ),
                        ),
                    ),
                    Equal(
                        Field(
                            Some(
                                "m",
                            ),
                            "released",
                        ),
                        Constant(
                            Integer(
                                2000,
                            ),
                        ),
                    ),
                ),
            },
            labels: [
                None,
                None,
                None,
            ],
            expressions: [
                Field(
                    Some(
                        "m",
                    ),
                    "id",
                ),
                Field(
                    Some(
                        "m",
                    ),
                    "title",
                ),
                Field(
                    Some(
                        "g",
                    ),
                    "name",
                ),
            ],
        },
    ),
)

Optimized plan: Plan(
    Explain(
        Projection {
            source: Filter {
                source: NestedLoopJoin {
                    outer: Scan {
                        table: "movies",
                        alias: Some(
                            "m",
                        ),
                    },
                    inner: Scan {
                        table: "genres",
                        alias: Some(
                            "g",
                        ),
                    },
                    predicate: Some(
                        Equal(
                            Field(
                                Some(
                                    "m",
                                ),
                                "genre_id",
                            ),
                            Field(
                                Some(
                                    "g",
                                ),
                                "id",
                            ),
                        ),
                    ),
                    pad: false,
                    flip: false,
                },
                predicate: Or(
                    GreaterThan(
                        Field(
                            Some(
                                "m",
                            ),
                            "released",
                        ),
                        Constant(
                            Integer(
                                2000,
                            ),
                        ),
                    ),
                    Equal(
                        Field(
                            Some(
                                "m",
                            ),
                            "released",
                        ),
                        Constant(
                            Integer(
                                2000,
                            ),
                        ),
                    ),
                ),
            },
            labels: [
                None,
                None,
                None,
            ],
            expressions: [
                Field(
                    Some(
                        "m",
                    ),
                    "id",
                ),
                Field(
                    Some(
                        "m",
                    ),
                    "title",
                ),
                Field(
                    Some(
                        "g",
                    ),
                    "name",
                ),
            ],
        },
    ),
)

Query: EXPLAIN SELECT m.id, m.title, g.name FROM movies m JOIN GENRES g ON m.genre_id = g.id WHERE m.released >= 2000

Result: Projection {
    source: Filter {
        source: NestedLoopJoin {
            outer: Scan {
                table: "movies",
                alias: Some(
                    "m",
                ),
            },
            inner: Scan {
                table: "genres",
                alias: Some(
                    "g",
                ),
            },
            predicate: Some(
                Equal(
                    Field(
                        Some(
                            "m",
                        ),
                        "genre_id",
                    ),
                    Field(
                        Some(
                            "g",
                        ),
                        "id",
                    ),
                ),
            ),
            pad: false,
            flip: false,
        },
        predicate: Or(
            GreaterThan(
                Field(
                    Some(
                        "m",
                    ),
                    "released",
                ),
                Constant(
                    Integer(
                        2000,
                    ),
                ),
            ),
            Equal(
                Field(
                    Some(
                        "m",
                    ),
                    "released",
                ),
                Constant(
                    Integer(
                        2000,
                    ),
                ),
            ),
        ),
    },
    labels: [
        None,
        None,
        None,
    ],
    expressions: [
        Field(
            Some(
                "m",
            ),
            "id",
        ),
        Field(
            Some(
                "m",
            ),
            "title",
        ),
        Field(
            Some(
                "g",
            ),
            "name",
        ),
    ],
}